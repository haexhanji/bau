export default function FeeSelector() {
  const FEES = {
    1: 23230,
    2: 54414,
    3: 116782,
    4: 27794,
    5: 23230,
  };

  const FEE_LABELS = {
    1: "1번 금액",
    2: "2번 금액",
    3: "3번 금액",
    4: "4번 금액",
    5: "5번 금액",
  };

  const ACCOUNT = {
    bank: "토스뱅크",
    number: "1002-2565-8632",
    holder: "예금주 이름",
  };

  const [major, setMajor] = React.useState("");
  const [type, setType] = React.useState("");
  const [role, setRole] = React.useState("");
  const [monitorUse, setMonitorUse] = React.useState("");
  const [monitorCount, setMonitorCount] = React.useState("");

  const resetBelow = (level) => {
    if (level === "major") {
      setType("");
      setRole("");
      setMonitorUse("");
      setMonitorCount("");
    }
    if (level === "type") {
      setRole("");
      setMonitorUse("");
      setMonitorCount("");
    }
    if (level === "role") {
      setMonitorUse("");
      setMonitorCount("");
    }
    if (level === "monitorUse") {
      setMonitorCount("");
    }
  };

  const computeFee = () => {
    if (major === "영상미디어") {
      if (type === "상영") {
        if (!role) return null;
        return role === "조장(대표)" ? { id: 4, amount: FEES[4] } : { id: 5, amount: FEES[5] };
      }
      if (type === "전시") {
        if (!monitorUse) return null;
        if (monitorUse === "미사용") {
          return { id: 1, amount: FEES[1] };
        }
        if (!role) return null;
        if (role === "팀원") {
          return { id: 1, amount: FEES[1] };
        }
        if (!monitorCount) return null;
        if (monitorCount === "1개") return { id: 2, amount: FEES[2] };
        if (monitorCount === "3개") return { id: 3, amount: FEES[3] };
      }
      return null;
    }

    if (major === "영화콘텐츠") {
      if (!role) return null;
      return role === "조장(대표)" ? { id: 4, amount: FEES[4] } : { id: 5, amount: FEES[5] };
    }

    return null;
  };

  const result = computeFee();
  const money = (n) => new Intl.NumberFormat("ko-KR").format(n);

  const canCopy = !!result;

  const copyAll = async () => {
    if (!result) return;
    const text = `납부 금액: ${FEE_LABELS[result.id]} — ${money(result.amount)}원\n계좌: ${ACCOUNT.bank} ${ACCOUNT.number} (${ACCOUNT.holder})`;
    try {
      await navigator.clipboard.writeText(text);
      alert("금액/계좌 정보가 복사되었습니다.");
    } catch (e) {
      alert("복사에 실패했습니다. 브라우저 설정을 확인해 주세요.");
    }
  };

  return (
    <div className="min-h-screen w-full bg-neutral-50 py-8 px-4">
      <div className="mx-auto max-w-3xl">
        <header className="mb-6">
          <h1 className="text-2xl md:text-3xl font-bold tracking-tight">전시/상영 수금 선택</h1>
          <p className="text-neutral-600 mt-2 text-sm md:text-base">
            아래 문항을 순서대로 선택하면 납부 금액과 계좌 정보가 표시됩니다.
          </p>
        </header>
        {/* 이하 동일 */}
      </div>
    </div>
  );
}
